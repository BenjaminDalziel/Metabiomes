\documentclass{article}

% Packages for applied mathematics
\usepackage{amsmath} % Enhanced math functionality
\usepackage{amsfonts} % Additional math fonts
\usepackage{amssymb} % Additional math symbols
\usepackage{parskip}

\begin{document}

\section*{Supplemental Material}

\subsection*{Generalized Lotka-Voltera}

The generalized Lotka-Volterra model is
\begin{align}
\dfrac{dN_i}{dt} &= N_i\left(r_i + \sum_k a_{ik}N_k\right) \equiv f_i(N)\\
&=r_iN_i + N_i\sum_k a_{ik}N_k \\
&=r_iN_i + a_{ii} N_i^2 + N_i \sum_{k\neq i} a_{ik}N_k
\end{align}

Assume there is an equilibrium $N^*$ where $N^*_i>0$. For all $i$ that equilibrium must satisfy
\begin{equation}
f_i(N^*) = 0
\end{equation}

\begin{equation}
r_iN^*_i + a_{ii} (N^*_i)^2 + N^*_i \sum_{k\neq i} a_{ik}N^*_k = 0
\end{equation}

\begin{equation}
r_i + a_{ii} N^*_i + \sum_{k\neq i} a_{ik}N^*_k = 0 
\end{equation}

So 
\begin{equation}
-a_{ii} N^*_i = r_i + \sum_{k\neq i} a_{ik}N^*_k
\end{equation}

The diagonal of the Jacobian is
\begin{equation}
\dfrac{\partial f_i}{\partial N_i} = r_i + 2a_{ii} N_i + \sum_{k\neq i} a_{ik}N_k
\end{equation}

We evaluate the Jacobian at the equilrium $N_i^*$, using the relationship given in equation 7
\begin{align}
    \left.\dfrac{\partial f_i}{\partial N_i} \right \rvert_{N^*} 
    &= r_i + 2a_{ii} N^*_i + \sum_{k\neq i} a_{ik}N^*_k \\
    &= 2a_{ii} N^*_i - a_{ii}N^*_i \\ 
    &= a_{ii} N^*_i
\end{align}

For the off-diagonal
\begin{align}
    \left.\dfrac{\partial f_i}{\partial N_j} \right \rvert_{N^*} 
    &=a_{ij} N^*_i
\end{align}


\subsection*{Generalized Lotka-Volterra in a Metacommunity}

Let $N_i$ represent the population size for a particular taxa-location combination within the metacommunity. Let $t(i)$ return the taxa associated with $i$ and let $l(i)$ return the location associated with $i$.

The generalized Lotka-Volterra model is
\begin{align}
\dfrac{dN_i}{dt} 
&= N_i\left(r_i+\sum_k a_{ik}N_k\right)-mN_i+\sum_k m_{ik}N_k \equiv f_i(N) \\
\notag\\
&=r_iN_i + a_{ii}N_i^2 + N_i\sum_{k\neq i} a_{ik}N_k - mN_i + \sum_k m_{ik} N_k
\end{align}
where $a_{ii} = s_i$ represents the strength of intraspecific competition.

Species interactions only occur for different taxa in the same location. Thus
\begin{equation}
    a_{ij} = 
    \left\{
        \begin{array}{ll}
            X_{ij}, & \text{if } l(i) = l(j) \text{ and } t(i) \neq t(j)\\
            \\
            0, & \text{otherwise}
            \end{array}
            \right.
\end{equation}
where $X_{ij}$ is a random variable whose distribution is parameterized as described below.

Individuals emigrate from a location at per-capita rate $m$. We assume that individual who emigrate select another location to immigrate to at random, with each of the $M-1$ other locations are given equal weight. Thus the rate at which individuals emigrating from $j$ arrive at $i$ is given by
\begin{equation}
    m_{ij} = 
    \left\{
        \begin{array}{ll}
            \dfrac{m}{M-1}, & \text{if } l(i) \neq l(j) \text{ and } t(i) = t(j) \\
            \\
            0, & \text{otherwise}
        \end{array}
        \right.
\end{equation}
where the 0s occur because migration can only occur when $i$ and $j$ refer to the same taxa (in different locations).

\subsection*{Jacobian}
For the diagonal,
\begin{equation}
\dfrac{\partial f_i}{\partial N_i} = r_i + 2a_{ii}N_i + \sum_{k \neq i} a_{ik}N_k - m 
\end{equation}

For the off-diagonal,
\begin{equation}
\dfrac{\partial f_i}{\partial N_j} = a_{ij} N_i + m_{ij}
\end{equation}

Evaluating the Jacobian at the equilibrium $N^*$. Assume there is an equilibrium $N^*$ that satisfies $N^*_i>0$ for all $i$.
\begin{equation}
    N^*_i\left(r_i+\sum_k a_{ik}N^*_k\right)-mN^*_i+\sum_k m_{ik}N_k=0
\end{equation}
Dividing by $N_i^*$
\begin{equation}
r_i+\sum_k a_{ik}N^*_k-m+\dfrac{1}{N^*_i}\sum_k m_{ik}N^*_k=0
\end{equation}

Breaking apart the first sum to pull out intraspecific competition,
\begin{equation}
    r_i+a_{ii}N_i^* + \sum_{k \neq i} a_{ik}N^*_k-m+\dfrac{1}{N^*_i}\sum_k m_{ik}N^*_k=0
\end{equation}
So
\begin{equation}
    r_i+\sum_{k \neq i} a_{ik}N^*_k-m=-a_{ii}N_i^* - \dfrac{1}{N^*_i}\sum_k m_{ik}N^*_k
\end{equation}
So
\begin{align}
    \left.\dfrac{\partial f_i}{\partial N_i} \right \rvert_{N^*} 
    &= r_i + 2a_{ii} N^*_i + \sum_{k\neq i} a_{ik}N^*_k - m \\
    &= 2a_{ii}N^*_i-a_{ii}N_i^* - \dfrac{1}{N^*_i}\sum_k m_{ik}N^*_k \\
    &= a_{ii}N^*_i - \dfrac{1}{N^*_i}\sum_k m_{ik}N^*_k
\end{align}
and
\begin{align}
    \left.\dfrac{\partial f_i}{\partial N_j} \right \rvert_{N^*} 
    &= a_{ij} N^*_i + m_{ij}
\end{align}

\subsubsection*{Dealing with migration}
We can write the Jacobian evaluated at $N^*$ as the sum of two terms where there first term is $D A$ where $D$ is the diagonal matrix with entries $N^*$ The second term represents the impact of migration. Along the diagonal this term is $- \dfrac{1}{N^*_i}\sum_k m_{ik}N^*_k$, and on the off-diagonal it is $m_{ij}$.
\begin{equation}
J = DA + M
\end{equation}
where $M$ is the matrix that holds the migration terms.

\subsubsection*{Finding a feasible equilibrium when there is migration}
The generalized Lotka-Volterra model is
\begin{align}
\dfrac{dN_i}{dt} 
&= N_i\left(r_i+\sum_k a_{ik}N_k\right)-mN_i+\sum_k m_{ik}N_k \equiv f_i(N) \\
\notag\\
&=r_iN_i + a_{ii}N_i^2 + N_i\sum_{k\neq i} a_{ik}N_k - mN_i + \sum_k m_{ik} N_k \\
\notag\\
&=\sum_k m_{ik} N_k + \left(r_i + \sum_{k\neq i} a_{ik}N_k - m\right) N_i + a_{ii}N_i^2
\end{align}
where $a_{ii} = s_i$ represents the strength of intraspecific competition.

We think that Descartes rule of signs says that this must have a positive real root. We are not sure whether Descartes rule applies to the roots of systems of polynomials but can't see why it wouldn't. The reasoning is that the first term (constant) is positive, the second (linear) is either positive or negative, and the third (quadratic) is negative. So there is exactly one sign change, that is either between the constant and linear term or the linear and quadratic term depending on the value of the linear coefficient. This implies that any non-zero amount of migration will guarentee the metacommunity has a feasible equilibrium which is suprising. 

At a feasibile equilibrium,
\begin{align}
f_i(N^*) &= 0 \notag \\
\notag \\
\dfrac{1}{N_i}f_i(N^*) &= 0 \notag \\
\notag \\
r_i + a_{ii}N_i^* + \sum_{k\neq i} a_{ik}N_k^* - m + \dfrac{1}{N_i^*}\sum_k m_{ik} N_k^* &= 0 
\end{align}
Which we could write as
\begin{equation}
r + AN^* + stuff = 0
\end{equation}
And if $stuff$ were 0 we could solve for $N^*$ as
\begin{equation}
N^*_{m=0} = -A^{-1} \cdot r
\end{equation}
Let
\begin{equation} 
g_i(N^*) = - m + \dfrac{1}{N_i^*}\sum_k m_{ik} N_k^*
\end{equation}
So we are trying to solve
\begin{equation} 
r + AN^* + g(N^*) = 0 
\end{equation}
So
\begin{equation} 
AN^* = -g(N^*) -r
\end{equation}
and
\begin{equation} 
N^* = -A^{-1}\left(g(N^*) +r\right)
\end{equation}
What if we used the approximation $N^* = N^*_{m=0}=-A^{-1} \cdot r$ when evaluating $g$?
Then we approximate $N^*$ as
\begin{equation} 
    \hat N^* = -A^{-1}\left(g(-A^{-1} \cdot r) +r\right)
\end{equation}
We could at least use this as the point near the root to pass to fsolve.

\end{document}